webpackJsonp([1],{"3Qrg":function(t,e){},"86Bi":function(t,e){},D3jO:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"background-color":"rgba(235, 235, 235, 0.08)"},attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var i=a("VU/8")({name:"app"},n,!1,function(t){a("D3jO")},null,null).exports,o=a("/ocq"),r=a("mtWM"),l=a.n(r),d=function(t,e){return l()({method:"put",url:""+t,data:e,transformRequest:[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})},c=function(t,e){return l()({method:"get",data:e,transformRequest:[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"},url:""+t})},u=function(t,e){return l()({method:"post",url:""+t,data:e,headers:{"Content-Type":"application/json"}})},p=function(t,e){return l()({method:"put",url:""+t,data:e,headers:{"Content-Type":"application/json"}})},m=function(t,e){return l()({method:"get",url:""+t,params:e})},f={data:function(){return{rules:{username:[{required:!0,message:"ユーザー名を入力してください",trigger:"blur"}],password:[{required:!0,message:"パスワードを入力してください",trigger:"blur"}]},checked:!0,loginForm:{username:"admin",password:"123"},loading:!1}},methods:{submitClick:function(){var t,e,a=this;this.loading=!0,(t="/login",e={username:this.loginForm.username,password:this.loginForm.password},l()({method:"post",url:""+t,data:e,transformRequest:[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})).then(function(t){(a.loading=!1,200==t.status)?"success"==t.data.status?a.$router.replace({path:"/home"}):a.$alert("ログイン失敗","エラー"):a.$alert("ログイン失敗","エラー")},function(t){a.loading=!1,a.$alert("サーバーが見つかりません ⊙﹏⊙∥","エラー")})}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"login-container",attrs:{model:t.loginForm,rules:t.rules,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"login_title"},[t._v("ログイン")]),t._v(" "),a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"ユーザー名"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"パスワード"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),t._v(" "),a("el-checkbox",{staticClass:"login_remember",attrs:{"label-position":"left"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("パスワードを記憶する")]),t._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.submitClick.apply(null,arguments)}}},[t._v("ログイン")])],1)],1)},staticRenderFns:[]};var v=a("VU/8")(f,h,!1,function(t){a("86Bi")},null,null).exports,g={methods:{handleCommand:function(t){var e=this;"logout"==t&&this.$confirm("ログアウトしますか？","確認",{confirmButtonText:"はい",cancelButtonText:"いいえ",type:"warning"}).then(function(){c("/logout"),e.currentUserName="ゲスト",e.$router.replace({path:"/"})},function(){})}},mounted:function(){this.$alert("演示用のデータベースですので、閲覧・一部編集のみ可能です。全権限での操作はローカル環境でご確認ください。","お知らせ",{confirmButtonText:"OK",callback:function(t){}});var t=this;c("/currentUserName").then(function(e){t.currentUserName=e.data||"ゲスト"},function(e){t.currentUserName="ゲスト"})},data:function(){return{currentUserName:""}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"home_container"},[a("el-header",[a("div",{staticClass:"home_title"},[t._v("TASKER タスク管理システム")]),t._v(" "),a("div",{staticClass:"home_userinfoContainer"},[a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"el-dropdown-link home_userinfo"},[t._v("\n  "+t._s(t.currentUserName)),a("i",{staticClass:"el-icon-arrow-down el-icon--right home_userinfo"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"sysMsg"}},[t._v("システム通知")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"logout",divided:""}},[t._v("ログアウト")])],1)],1)],1)]),t._v(" "),a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"background-color":"#ECECEC"},attrs:{"default-active":"0",router:""}},[t._l(this.$router.options.routes,function(e,s){return e.hidden?t._e():[e.children.length>1?a("el-submenu",{key:s,attrs:{index:s+""}},[a("template",{slot:"title"},[a("i",{class:e.iconCls}),t._v(" "),a("span",[t._v(t._s(e.name))])]),t._v(" "),t._l(e.children,function(e){return e.hidden?t._e():a("el-menu-item",{key:e.path,attrs:{index:e.path}},[t._v("\n              "+t._s(e.name)+"\n            ")])})],2):[a("el-menu-item",{attrs:{index:e.children[0].path}},[a("i",{class:e.children[0].iconCls}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.children[0].name))])])]]})],2)],1),t._v(" "),a("el-container",[a("el-main",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("ホーム")]),t._v(" "),a("el-breadcrumb-item",{domProps:{textContent:t._s(this.$router.currentRoute.name)}})],1),t._v(" "),a("keep-alive",[this.$route.meta.keepAlive?a("router-view"):t._e()],1),t._v(" "),this.$route.meta.keepAlive?t._e():a("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var _=a("VU/8")(g,k,!1,function(t){a("iCws")},null,null).exports,b={mounted:function(){this.loading=!0,this.loadUserList(),this.cardloading=Array.apply(null,Array(20)).map(function(t,e){return!1}),this.eploading=Array.apply(null,Array(20)).map(function(t,e){return!1})},methods:{saveRoles:function(t,e){var a=this.roles;if(this.cpRoles.length==a.length){for(var s=0;s<this.cpRoles.length;s++)for(var n=0;n<a.length;n++)if(this.cpRoles[s].id==a[n]){a.splice(n,1);break}if(0==a.length)return}var i=this;i.cardloading.splice(e,1,!0),d("/admin/user/role",{rids:this.roles,id:t}).then(function(a){200==a.status&&"success"==a.data.status?(i.$message({type:a.data.status,message:a.data.msg}),i.loadOneUserById(t,e)):(i.cardloading.splice(e,1,!1),i.$message({type:"error",message:"更新失敗!"}))},function(t){if(i.cardloading.splice(e,1,!1),403==t.response.status){var a=t.response.data;i.$message({type:"error",message:a})}})},showRole:function(t,e,a){this.cpRoles=t,this.roles=[],this.loadRoles(a);for(var s=0;s<t.length;s++)this.roles.push(t[s].id)},deleteUser:function(t){var e=this;this.$confirm("このユーザーを削除しますか？","確認",{confirmButtonText:"OK",cancelButtonText:"キャンセル",type:"warning"}).then(function(){var a;e.loading=!0,(a="/admin/user/"+t,l()({method:"delete",url:""+a})).then(function(t){if(200==t.status&&"success"==t.data.status)return e.$message({type:"success",message:"削除成功!"}),void e.loadUserList();e.loading=!1,e.$message({type:"error",message:"削除失敗!"})},function(t){e.loading=!1,e.$message({type:"error",message:"削除失敗!"})})}).catch(function(){e.$message({type:"info",message:"削除をキャンセルしました"})})},enabledChange:function(t,e,a){var s=this;s.cardloading.splice(a,1,!0),d("/admin/user/enabled",{enabled:t,uid:e}).then(function(t){if(200!=t.status)return s.$message({type:"error",message:"更新失敗!"}),void s.loadOneUserById(e,a);s.cardloading.splice(a,1,!1),s.$message({type:"success",message:"更新成功!"})},function(t){s.$message({type:"error",message:"更新失敗!"}),s.loadOneUserById(e,a)})},loadRoles:function(t){var e=this;e.eploading.splice(t,1,!0),c("/admin/roles").then(function(a){e.eploading.splice(t,1,!1),200==a.status?e.allRoles=a.data:e.$message({type:"error",message:"データの読み込みに失敗しました!"})},function(a){if(e.eploading.splice(t,1,!1),403==a.response.status){var s=a.response.data;e.$message({type:"error",message:s})}})},loadOneUserById:function(t,e){var a=this;c("/admin/user/"+t).then(function(t){a.cardloading.splice(e,1,!1),200==t.status?a.users.splice(e,1,t.data):a.$message({type:"error",message:"データの読み込みに失敗しました!"})},function(t){if(a.cardloading.splice(e,1,!1),403==t.response.status){var s=t.response.data;a.$message({type:"error",message:s})}})},loadUserList:function(){var t=this;c("/admin/user?nickname="+this.keywords).then(function(e){t.loading=!1,200==e.status?t.users=e.data:t.$message({type:"error",message:"データの読み込みに失敗しました!"})},function(e){if(t.loading=!1,403==e.response.status){var a=e.response.data;t.$message({type:"error",message:a})}})},searchClick:function(){this.loading=!0,this.loadUserList()}},data:function(){return{loading:!1,eploading:[],cardloading:[],keywords:"",users:[],allRoles:[],roles:[],cpRoles:[]}}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticStyle:{"margin-top":"10px",display:"flex","justify-content":"center"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"ユーザー名で検索できます...","prefix-icon":"el-icon-search",size:"small"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._v(" "),a("el-button",{staticStyle:{"margin-left":"3px"},attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.searchClick}},[t._v("\n      検索\n    ")])],1),t._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-around","flex-wrap":"wrap"}},t._l(t.users,function(e,s){return a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.cardloading[s],expression:"cardloading[index]"}],key:s,staticStyle:{width:"330px","margin-top":"10px"}},[a("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(e.nickname))]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"#ff0509"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.deleteUser(e.id)}}},[t._v("削除\n        ")])],1),t._v(" "),a("div",[a("div",[a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.userface,alt:e.nickname}})]),t._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[t._v("ユーザー名:")]),a("span",[t._v(t._s(e.username))])]),t._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[t._v("メールアドレス:")]),a("span",[t._v(t._s(e.email))])]),t._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[t._v("登録日時:")]),a("span",[t._v(t._s(t._f("formatDateTime")(e.regTime)))])]),t._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px",display:"flex","align-items":"center"}},[a("span",[t._v("ユーザー状態:")]),t._v(" "),a("el-switch",{staticStyle:{"font-size":"12px"},attrs:{"active-text":"有効","active-color":"#13ce66","inactive-text":"無効"},on:{change:function(a){return t.enabledChange(e.enabled,e.id,s)}},model:{value:e.enabled,callback:function(a){t.$set(e,"enabled",a)},expression:"user.enabled"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[t._v("ユーザー権限:")]),t._v(" "),t._l(e.roles,function(e){return a("el-tag",{key:e.id,staticStyle:{"margin-right":"8px"},attrs:{size:"mini",type:"success"}},[t._v("\n            "+t._s(e.name)+"\n          ")])}),t._v(" "),a("el-popover",{directives:[{name:"loading",rawName:"v-loading",value:t.eploading[s],expression:"eploading[index]"}],key:s+""+e.id,attrs:{placement:"right",title:"権限一覧",width:"200",trigger:"click"},on:{hide:function(a){return t.saveRoles(e.id,s)}}},[a("el-select",{key:e.id,attrs:{multiple:"",placeholder:"選択してください",size:"mini"},model:{value:t.roles,callback:function(e){t.roles=e},expression:"roles"}},t._l(t.allRoles,function(t,s){return a("el-option",{key:e.id+"-"+t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),a("el-button",{staticStyle:{"padding-top":"0px"},attrs:{slot:"reference",type:"text",icon:"el-icon-more"},on:{click:function(a){return t.showRole(e.roles,e.id,s)}},slot:"reference"})],1)],2)])])}),1)])},staticRenderFns:[]},w=a("VU/8")(b,y,!1,null,null,null).exports,x=a("oqQY"),$=a.n(x),T={props:{statusId:{type:[String,Number],default:"0"},priorityId:{type:[String,Number],default:""},showEdit:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},showRestore:{type:Boolean,default:!1},showUpdate:{type:Boolean,default:!1},activeName:{type:[String,Number],default:"0"},isAdmin:{type:Boolean,default:!1}},data:function(){return{tasks:[],selectedTasks:[],currentPage:1,pageSize:6,totalCount:0,keywords:"",loading:!1,updateDialogVisible:!1,updateTask:{id:null,statusId:null,progress:0},statuses:[]}},watch:{statusId:{immediate:!0,handler:function(){this.loadTasks()}}},mounted:function(){this.loadTasks(this.currentPage),window.bus&&window.bus.$on&&window.bus.$on("taskTableReload",this.handleTableReload)},beforeDestroy:function(){window.bus&&window.bus.$off&&window.bus.$off("taskTableReload",this.handleTableReload)},methods:{handleTableReload:function(){this.loadTasks(this.currentPage)},loadTasks:function(t){var e=this;this.loading=!0;var a={page:t,pageSize:this.pageSize,keywords:this.keywords};null!==this.statusId&&void 0!==this.statusId&&(a.statusId=this.statusId),null!==this.priorityId&&void 0!==this.priorityId&&(a.priorityId=this.priorityId),m("/tasks",a).then(function(t){if(e.loading=!1,t.data&&"error"===t.data.status&&t.data.msg&&-1!==t.data.msg.indexOf("未登录"))return e.$message.error("先にログインしてください"),void("/"!==e.$route.path&&e.$router.push("/"));t.data&&(e.tasks=t.data.data||[],e.totalCount=t.data.totalCount||0)})},formatDate:function(t){return t?$()(t).format("YYYY-MM-DD"):""},currentChange:function(t){this.currentPage=t,this.loadTasks(t)},searchClick:function(){this.currentPage=1,this.loadTasks(this.currentPage)},handleSelectionChange:function(t){this.selectedTasks=t},goToDetail:function(t){this.$router.push({path:"/taskDetail",query:{id:t.id}})},editTask:function(t){this.$router.push({path:"/postTask",query:{id:t.id,from:this.activeName}})},openUpdateDialog:function(t){this.updateTask.id=t.id,this.updateTask.statusId=t.statusId,this.updateTask.progress=t.progress||0,this.updateDialogVisible=!0},submitUpdate:function(){var t=this;p("/tasks/status",{taskIds:[parseInt(this.updateTask.id)],statusId:this.updateTask.statusId,progress:this.updateTask.progress}).then(function(e){e.data&&"success"===e.data.status?(t.$message.success("更新しました"),t.updateDialogVisible=!1,t.loadTasks(t.currentPage)):t.$message.error(e.data&&e.data.msg||"更新失敗")})},deleteTask:function(t,e){var a=this;this.$confirm("このタスクを削除しますか？","確認",{confirmButtonText:"はい",cancelButtonText:"キャンセル",type:"warning"}).then(function(){p("/tasks/status",{taskIds:[t],statusId:5===e?99:5}).then(function(t){t.data&&"success"===t.data.status?(a.$message.success(t.data.msg),a.loadTasks(a.currentPage)):a.$message.error(t.data&&t.data.msg||"削除失敗")})}).catch(function(){a.$message.info("削除をキャンセルしました")})},deleteMany:function(){var t=this;if(0!==this.selectedTasks.length){var e=this.selectedTasks.map(function(t){return t.id}),a=5===this.selectedTasks[0].statusId?99:5;this.$confirm("選択したタスクを一括削除しますか？","確認",{confirmButtonText:"はい",cancelButtonText:"キャンセル",type:"warning"}).then(function(){p("/tasks/status",{taskIds:e,statusId:a}).then(function(e){e.data&&"success"===e.data.status?(t.$message.success(e.data.msg),t.loadTasks(t.currentPage)):t.$message.error(e.data&&e.data.msg||"削除失敗")})}).catch(function(){t.$message.info("削除をキャンセルしました")})}},restoreTask:function(t){var e=this;p("/tasks/status",{taskIds:[t],statusId:1}).then(function(t){t.data&&"success"===t.data.status?(e.$message.success(t.data.msg),e.loadTasks(e.currentPage)):e.$message.error(t.data&&t.data.msg||"復元失敗")})}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"flex","justify-content":"flex-start","margin-bottom":"10px"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"タスク名で検索...","prefix-icon":"el-icon-search",size:"mini"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._v(" "),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.searchClick}},[t._v("検索")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"taskTable",staticStyle:{width:"100%"},attrs:{data:t.tasks,"row-key":function(t){return t.id},"tooltip-effect":"dark","max-height":"500"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35",selectable:function(e){return t.showDelete},"reserve-selection":!0}}),t._v(" "),a("el-table-column",{attrs:{label:"タスク番号",prop:"taskCode",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(a){return t.goToDetail(e.row)}}},[t._v("\n          "+t._s(e.row.taskCode)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"タスク名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statusName",label:"状態",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"priorityName",label:"優先度",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"progress",label:"進捗",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-progress",{attrs:{percentage:t.row.progress||0,"show-text":!0,"stroke-width":10}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"startDate",label:"開始日時",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.formatDate(e.row.startDate))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"deadline",label:"期限",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.formatDate(e.row.deadline))+"\n      ")]}}])}),t._v(" "),t.isAdmin?a("el-table-column",{attrs:{prop:"nickname",label:"担当者",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.nickname||"-"))])]}}],null,!1,3658550019)}):t._e(),t._v(" "),t.showEdit||t.showDelete||t.showRestore||t.showUpdate?a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.showEdit?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.editTask(e.row)}}},[t._v("編集")]):t._e(),t._v(" "),t.showRestore?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.restoreTask(e.row.id)}}},[t._v("復元")]):t._e(),t._v(" "),t.showDelete?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.deleteTask(e.row.id,e.row.statusId)}}},[t._v("削除")]):t._e(),t._v(" "),t.showUpdate?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.openUpdateDialog(e.row)}}},[t._v("更新")]):t._e()]}}],null,!1,845490317)}):t._e()],1),t._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-between","padding-top":"10px"}},[t.showDelete?a("el-button",{attrs:{type:"danger",size:"mini",disabled:0===t.selectedTasks.length},on:{click:t.deleteMany}},[t._v("一括削除")]):t._e(),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tasks.length>0,expression:"tasks.length > 0"}],attrs:{background:"",layout:"prev, pager, next",total:t.totalCount,"page-size":t.pageSize,"current-page":t.currentPage},on:{"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"タスク進捗の更新",visible:t.updateDialogVisible,width:"400px"},on:{"update:visible":function(e){t.updateDialogVisible=e}}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"状態"}},[a("el-select",{attrs:{placeholder:"ステータスを選択してください"},model:{value:t.updateTask.statusId,callback:function(e){t.$set(t.updateTask,"statusId",e)},expression:"updateTask.statusId"}},[a("el-option",{attrs:{label:"未開始",value:1}}),t._v(" "),a("el-option",{attrs:{label:"進行中",value:2}}),t._v(" "),a("el-option",{attrs:{label:"完了",value:3}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"進捗（％）"}},[a("el-input-number",{attrs:{min:0,max:100,step:5},model:{value:t.updateTask.progress,callback:function(e){t.$set(t.updateTask,"progress",e)},expression:"updateTask.progress"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.updateDialogVisible=!1}}},[t._v("キャンセル")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitUpdate}},[t._v("更新")])],1)],1)],1)},staticRenderFns:[]},D=a("VU/8")(T,C,!1,null,null,null).exports,I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"taskcfg-container"},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"cfg-title"},[t._v("タスク通知設定")])]),t._v(" "),a("el-form",{attrs:{model:t.config,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"通知有効"}},[a("el-switch",{model:{value:t.config.taskNotificationEnabled,callback:function(e){t.$set(t.config,"taskNotificationEnabled",e)},expression:"config.taskNotificationEnabled"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"通知先メールアドレス"}},[a("el-input",{attrs:{placeholder:"メールアドレスを入力してください"},model:{value:t.config.notifyEmail,callback:function(e){t.$set(t.config,"notifyEmail",e)},expression:"config.notifyEmail"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.saveSetting}},[t._v("設定を保存")])],1)],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")({name:"TaskCfg",data:function(){return{config:{taskNotificationEnabled:!1,notifyEmail:""}}},mounted:function(){},methods:{saveSetting:function(){this.$message.success("タスク通知設定が保存されました！")}}},I,!1,function(t){a("vwbl")},"data-v-1522d3b5",null).exports,S={data:function(){return{task:{taskCode:"",taskName:"",description:"",detailedDescription:"",statusId:null,priorityId:null,assigneeId:null,startDate:"",deadline:"",progress:0},from:null,assignees:[]}},mounted:function(){var t=this;this.from=this.$route.query.from;var e=this.$route.query.id;e&&m("/tasks/"+e).then(function(e){e.data&&"success"===e.data.status&&(t.task=e.data.data)}),this.fetchAssignees()},methods:{fetchAssignees:function(){var t=this;m("/user-api/all").then(function(e){e.data&&"success"===e.data.status&&(t.assignees=e.data.data)})},submitTask:function(){var t=this;(this.task.id?p:u)("/tasks",this.task).then(function(e){e.data&&"success"===e.data.status?(t.$message.success("保存しました"),window.bus&&window.bus.$emit&&window.bus.$emit("taskTableReload"),t.$router.push({path:"/taskList",query:{tab:"all"}})):t.$message.error(e.data&&e.data.msg||"保存に失敗しました")})},resetForm:function(){this.task={taskCode:"",taskName:"",description:"",detailedDescription:"",statusId:null,priorityId:null,assigneeId:null,startDate:"",deadline:"",progress:0}},cancelEdit:function(){this.$router.go(-1)}}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-main",[a("h2",[t._v(t._s(t.task.id?"タスク編集":"新規タスク作成"))]),t._v(" "),a("el-form",{staticStyle:{"max-width":"600px"},attrs:{model:t.task,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"タスクコード"}},[a("el-input",{model:{value:t.task.taskCode,callback:function(e){t.$set(t.task,"taskCode",e)},expression:"task.taskCode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"タスク名"}},[a("el-input",{model:{value:t.task.taskName,callback:function(e){t.$set(t.task,"taskName",e)},expression:"task.taskName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"ステータス"}},[a("el-select",{attrs:{placeholder:"選択してください"},model:{value:t.task.statusId,callback:function(e){t.$set(t.task,"statusId",e)},expression:"task.statusId"}},[a("el-option",{attrs:{label:"未開始",value:1}}),t._v(" "),a("el-option",{attrs:{label:"進行中",value:2}}),t._v(" "),a("el-option",{attrs:{label:"完了",value:3}}),t._v(" "),a("el-option",{attrs:{label:"延期",value:4}}),t._v(" "),a("el-option",{attrs:{label:"キャンセル",value:5}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"優先度"}},[a("el-select",{attrs:{placeholder:"選択してください"},model:{value:t.task.priorityId,callback:function(e){t.$set(t.task,"priorityId",e)},expression:"task.priorityId"}},[a("el-option",{attrs:{label:"低",value:1}}),t._v(" "),a("el-option",{attrs:{label:"中",value:2}}),t._v(" "),a("el-option",{attrs:{label:"高",value:3}}),t._v(" "),a("el-option",{attrs:{label:"緊急",value:4}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"進捗（％）"}},[a("el-input-number",{attrs:{min:0,max:100,label:"進捗"},model:{value:t.task.progress,callback:function(e){t.$set(t.task,"progress",e)},expression:"task.progress"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"担当者"}},[a("el-select",{attrs:{placeholder:"担当者を選択"},model:{value:t.task.assigneeId,callback:function(e){t.$set(t.task,"assigneeId",e)},expression:"task.assigneeId"}},t._l(t.assignees,function(t){return a("el-option",{key:t.id,attrs:{label:t.nickname,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"開始日時"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"選択してください"},model:{value:t.task.startDate,callback:function(e){t.$set(t.task,"startDate",e)},expression:"task.startDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"締切"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"選択してください"},model:{value:t.task.deadline,callback:function(e){t.$set(t.task,"deadline",e)},expression:"task.deadline"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"説明"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.task.description,callback:function(e){t.$set(t.task,"description",e)},expression:"task.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"詳細説明"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.task.detailedDescription,callback:function(e){t.$set(t.task,"detailedDescription",e)},expression:"task.detailedDescription"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{on:{click:t.resetForm}},[t._v("クリア")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitTask}},[t._v("保存")]),t._v(" "),t.from?a("el-button",{attrs:{type:"warning"},on:{click:t.cancelEdit}},[t._v("戻る")]):t._e()],1)],1)],1)},staticRenderFns:[]},A=a("VU/8")(S,R,!1,null,null,null).exports,U={name:"TaskList",components:{task_table:D,task_cfg:N,post_task:A},data:function(){return{activeName:this.$route.query.tab||"all",isAdmin:!1}},watch:{"$route.query.tab":function(t){t&&(this.activeName=t)}},mounted:function(){var t=this;this.$route.query.tab&&(this.activeName=this.$route.query.tab),c("/isAdmin").then(function(e){200===e.status&&(t.isAdmin=!!e.data)})},methods:{goToCreate:function(){this.$router.push("/postTask")},handleClick:function(t){this.$router.replace({path:"/taskList",query:{tab:t.name}}),this.activeName=t.name}}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"task_list"},[a("el-main",{staticClass:"main"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"すべて",name:"all"}},[a("task_table",{key:t.activeName,attrs:{"status-id":null,showEdit:!1,showDelete:!1,showRestore:!1,showUpdate:!1,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"未開始",name:"notStarted"}},[a("task_table",{key:t.activeName,attrs:{statusId:1,showEdit:!!t.isAdmin,showDelete:!!t.isAdmin,showRestore:!1,showUpdate:!t.isAdmin,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"進行中",name:"inProgress"}},[a("task_table",{key:t.activeName,attrs:{statusId:2,showEdit:!!t.isAdmin,showDelete:!!t.isAdmin,showRestore:!1,showUpdate:!t.isAdmin,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"完了",name:"completed"}},[a("task_table",{key:t.activeName,attrs:{statusId:3,showEdit:!!t.isAdmin,showDelete:!!t.isAdmin,showRestore:!1,showUpdate:!1,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"延期",name:"Postponed"}},[a("task_table",{key:t.activeName,attrs:{statusId:4,showEdit:!!t.isAdmin,showDelete:!!t.isAdmin,showRestore:!1,showUpdate:!t.isAdmin,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"キャンセル",name:"cancelled"}},[a("task_table",{key:t.activeName,attrs:{statusId:5,showEdit:!1,showDelete:!!t.isAdmin,showRestore:!!t.isAdmin,showUpdate:!1,activeName:t.activeName,isAdmin:!!t.isAdmin}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"タスク設定",name:"taskcfg"}},[a("task_cfg",{key:t.activeName})],1),t._v(" "),t.isAdmin?a("el-tab-pane",{attrs:{label:"新規作成",name:"taskCreate"}},[a("post_task",{key:t.activeName})],1):t._e()],1)],1)],1)},staticRenderFns:[]};var z=a("VU/8")(U,E,!1,function(t){a("3Qrg")},"data-v-f12f0870",null).exports,F={data:function(){return{task:{}}},mounted:function(){var t=this.$route.query.id;t?this.loadTask(t):this.$message.error("タスクIDが指定されていません")},methods:{loadTask:function(t){var e=this;m("/tasks/"+t).then(function(t){t.data&&"success"===t.data.status?e.task=t.data.data:e.$message.error(t.data.msg||"タスクの取得に失敗しました")})},progressTagType:function(t){return 100===t?"success":t>=60?"warning":"info"},formatDate:function(t){return t?$()(t).format("YYYY-MM-DD"):"-"},statusTagType:function(t){switch(t){case 1:return"info";case 2:return"primary";case 3:return"success";case 4:return"warning";case 5:return"danger";default:return""}}}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"task-detail-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[t._v(t._s(t.task.taskName))]),t._v(" "),a("el-tag",{attrs:{type:"info"}},[t._v("番号："+t._s(t.task.taskCode))])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:t.statusTagType(t.task.statusId)}},[t._v("状態："+t._s(t.task.statusName))])],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:t.progressTagType(t.task.progress)}},[t._v("進捗："+t._s(t.task.progress)+"%")])],1)],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:"warning"}},[t._v("優先度："+t._s(t.task.priorityName))])],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:"success"}},[t._v("担当者："+t._s(t.task.nickname))])],1)],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:""}},[t._v("開始日時："+t._s(t.formatDate(t.task.startDate)))])],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-tag",{attrs:{type:""}},[t._v("締切日時："+t._s(t.formatDate(t.task.deadline)))])],1)],1),t._v(" "),a("el-divider"),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("h3",[t._v("概要")]),t._v(" "),a("p",[t._v(t._s(t.task.description))])]),t._v(" "),a("div",[a("h3",[t._v("詳細説明")]),t._v(" "),a("div",{domProps:{innerHTML:t._s(t.task.detailedDescription)}})])],1)},staticRenderFns:[]};var q=a("VU/8")(F,B,!1,function(t){a("gQDm")},"data-v-55a0bda2",null).exports;s.default.use(o.a);var P=new o.a({routes:[{path:"/",name:"ログイン",hidden:!0,component:v},{path:"/home",name:"",component:_,hidden:!0},{path:"/home",component:_,name:"タスク管理",iconCls:"fa fa-tasks",children:[{path:"/taskList",name:"タスクリスト",component:z,meta:{keepAlive:!0}},{path:"/postTask",name:"タスク作成",component:A,hidden:!0,meta:{keepAlive:!1}},{path:"/taskDetail",name:"タスク詳細",component:q,hidden:!0,meta:{keepAlive:!1}},{path:"/editTask",name:"タスク編集",component:A,hidden:!0,meta:{keepAlive:!1}},{path:"/taskCfg",name:"通知設定",component:N,hidden:!0,meta:{keepAlive:!1}}]},{path:"/home",component:_,name:"ユーザー管理",children:[{path:"/user",iconCls:"fa fa-user-o",name:"ユーザー管理",component:w}]}]}),V=a("zL8q"),M=a.n(V);a("tvR6"),a("e0XP");s.default.filter("formatDate",function(t){var e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1,n=e.getDate();return s<10&&(s="0"+s),n<10&&(n="0"+n),a+"-"+s+"-"+n}),s.default.filter("formatDateTime",function(t){var e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1,n=e.getDate(),i=e.getHours(),o=e.getMinutes();return s<10&&(s="0"+s),n<10&&(n="0"+n),a+"-"+s+"-"+n+" "+i+":"+o}),s.default.use(M.a),s.default.config.productionTip=!1,window.bus=new s.default,new s.default({el:"#app",router:P,template:"<App/>",components:{App:i}})},e0XP:function(t,e){},gQDm:function(t,e){},iCws:function(t,e){},tvR6:function(t,e){},vwbl:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.d7ff8bf5052ba6de5768.js.map